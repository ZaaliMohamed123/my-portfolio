<section class="project-detail-page">
  <div class="container-custom">
    <!-- Loading State -->
    @if (isLoading) {
    <div class="loading-container">
      <div class="spinner"></div>
      <p>{{ 'projectDetail.loading' | transloco }}</p>
    </div>
    }

    <!-- Not Found State -->
    @if (!isLoading && notFound) {
    <div class="not-found-container">
      <i class="fas fa-exclamation-triangle"></i>
      <h2>{{ 'projectDetail.notFound.title' | transloco }}</h2>
      <p>{{ 'projectDetail.notFound.message' | transloco }}</p>
      <button (click)="goBack()" class="back-button">
        <i class="fas fa-arrow-left"></i>
        <span>{{ 'projectDetail.backToProjects' | transloco }}</span>
      </button>
    </div>
    }

    <!-- Project Content -->
    @if (!isLoading && !notFound && project) {
    <div class="project-content">
      <!-- Back Button -->
      <div class="back-navigation">
        <button (click)="goBack()" class="back-button">
          <i class="fas fa-arrow-left"></i>
          <span>{{ 'projectDetail.backToProjects' | transloco }}</span>
        </button>
      </div>

      <!-- Video Section (if exists) -->
      @if (project.videoTuto && safeVideoUrl) {
      <div class="video-section">
        <div class="video-container">
          <iframe
            [src]="safeVideoUrl"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen
            class="video-iframe"
          >
          </iframe>
        </div>
      </div>
      }

      <!-- Header Card (Logo, Title, Subtitle, GitHub) -->
      <div class="detail-card header-card">
        <div class="card-content">
          <div class="header-left">
            <!-- Project Logo -->
            @if (project.logo && project.logo.length > 0 && project.logo[0] &&
            project.logo[0].trim() !== '') {
            <div class="project-logo">
              <img [src]="project.logo[0]" [alt]="project.title + ' logo'" class="logo-image" />
            </div>
            }

            <!-- Title & Subtitle -->
            <div class="title-group">
              <h1 class="project-title">{{ project.title }}</h1>
              <p class="project-subtitle">{{ project.subtitle }}</p>
            </div>
          </div>

          <!-- GitHub Button -->
          @if (project.github) {
          <a
            [href]="project.github"
            target="_blank"
            rel="noopener noreferrer"
            class="github-button"
          >
            <i class="fab fa-github"></i>
            <span>{{ 'projectDetail.viewOnGitHub' | transloco }}</span>
          </a>
          }
        </div>
      </div>

      <!-- Description Card -->
      <div class="detail-card description-card">
        <div class="card-header">
          <i class="fas fa-file-alt"></i>
          <h2 class="card-title">{{ 'projectDetail.description' | transloco }}</h2>
        </div>
        <div class="card-content">
          @if (project.longDescription) {
          <p class="long-description">{{ project.longDescription }}</p>
          } @else {
          <p class="long-description">{{ project.description }}</p>
          }
        </div>
      </div>

      <!-- Technologies Card -->
      <div class="detail-card technologies-card">
        <div class="card-header">
          <i class="fas fa-code"></i>
          <h2 class="card-title">{{ 'projectDetail.technologies' | transloco }}</h2>
        </div>
        <div class="card-content">
          <div class="tech-grid">
            @for (tech of project.technologies; track tech.name) {
            <div class="tech-item">
              <div class="tech-icon-wrapper">
                @if (tech.isCustomIcon) {
                <img
                  [src]="tech.icon"
                  [alt]="tech.name"
                  class="tech-icon-img"
                  width="32"
                  height="32"
                />
                } @else {
                <i [class]="tech.icon + ' tech-icon'" [style.color]="tech.color"></i>
                }
              </div>
              <span class="tech-name">{{ tech.name }}</span>
            </div>
            }
          </div>
        </div>
      </div>

      <!-- Categories Card -->
      @if (project.categories && project.categories.length > 0) {
      <div class="detail-card categories-card">
        <div class="card-header">
          <i class="fas fa-tags"></i>
          <h2 class="card-title">{{ 'projectDetail.categories' | transloco }}</h2>
        </div>
        <div class="card-content">
          <div class="categories-grid">
            @for (category of project.categories; track category) {
            <div class="category-card">
              <div class="category-icon">
                @switch (category) { @case ('ai') {
                <i class="fas fa-brain"></i>
                } @case ('dl') {
                <i class="fas fa-network-wired"></i>
                } @case ('ml') {
                <i class="fas fa-robot"></i>
                } @case ('web') {
                <i class="fas fa-globe"></i>
                } @case ('data_science') {
                <i class="fas fa-chart-line"></i>
                } @case ('health_tech') {
                <i class="fas fa-heartbeat"></i>
                } @case ('big_data') {
                <i class="fas fa-database"></i>
                <!-- } @case ('cloud') {
                <i class="fas fa-cloud"></i>
                } @case ('mobile') {
                <i class="fas fa-mobile-alt"></i>
                } @case ('iot') {
                <i class="fas fa-microchip"></i> -->
                } @default {
                <i class="fas fa-folder"></i>
                } }
              </div>
              <span class="category-name">
                {{ 'projectsGallery.categories.' + category | transloco }}
              </span>
            </div>
            }
          </div>
        </div>
      </div>
      }

      <!-- Images Gallery (if multiple images) -->
      @if (project.images && project.images.length > 1) {
      <div class="detail-card gallery-card">
        <div class="card-header">
          <i class="fas fa-images"></i>
          <h2 class="card-title">{{ 'projectDetail.gallery' | transloco }}</h2>
        </div>
        <div class="card-content">
          <div class="images-gallery">
            @for (image of project.images; track image) { @if (image && image.trim() !== '') {
            <div class="gallery-item">
              <img [src]="image" [alt]="project.title" class="gallery-image" loading="lazy" />
            </div>
            } }
          </div>
        </div>
      </div>
      }
    </div>
    }
  </div>
</section>
