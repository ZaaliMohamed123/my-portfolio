<!-- Education Section -->
<section
  class="education-section fadeIn"
  id="education"
  #educationSection
  [class.in-view]="educationInView"
>
  <div class="container-custom">
    <!-- Section Header -->
    <div class="section-header">
      <h1 class="section-title">{{ 'education.title' | transloco }}</h1>
    </div>

    <!-- University Education Timeline -->
    <div class="education-timeline" [class.animate-in]="visibleSections.has('timeline')">
      <div class="timeline-header">
        <h2 class="timeline-title">
          <i class="fas fa-graduation-cap timeline-icon"></i>
          {{ 'education.university.title' | transloco }}
        </h2>
      </div>

      <div class="timeline-container">
        <!-- Timeline Line -->
        <div class="timeline-line"></div>

        <!-- Current Studies (2023-Present) -->
        <div class="timeline-item current-studies">
          <div class="timeline-year">
            <span class="year-badge current">{{
              'education.university.current.years' | transloco
            }}</span>
          </div>
          <div class="timeline-content">
            <div class="education-card current">
              <div class="card-header">
                <div class="card-icon current-icon"><i class="fas fa-graduation-cap"></i></div>
                <div class="card-title-group">
                  <h3 class="card-title">
                    {{ 'education.university.current.degree' | transloco }}
                  </h3>
                  <p class="card-status">{{ 'education.university.current.status' | transloco }}</p>
                </div>
              </div>
              <div class="card-body">
                <div class="field-info">
                  <strong>{{ 'education.university.current.field_label' | transloco }}:</strong>
                  <span>{{ 'education.university.current.field' | transloco }}</span>
                </div>
                <div class="option-info">
                  <strong>{{ 'education.university.current.option_label' | transloco }}:</strong>
                  <span>{{ 'education.university.current.option' | transloco }}</span>
                </div>
                <div class="institution-info">
                  <strong
                    >{{ 'education.university.current.institution_label' | transloco }}:</strong
                  >
                  <a
                    href="https://ensam.um5.ac.ma/"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="institution-link"
                  >
                    {{ 'education.university.current.institution' | transloco }}
                    <i class="fas fa-external-link-alt external-link"></i>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Preparatory Classes (2021-2023) -->
        <div class="timeline-item prep-classes">
          <div class="timeline-year">
            <span class="year-badge prep">{{ 'education.university.prep.years' | transloco }}</span>
          </div>
          <div class="timeline-content">
            <div class="education-card prep">
              <div class="card-header">
                <div class="card-icon prep-icon"><i class="fas fa-book"></i></div>
                <div class="card-title-group">
                  <h3 class="card-title">{{ 'education.university.prep.title' | transloco }}</h3>
                </div>
              </div>
              <div class="card-body">
                <div class="focus-info">
                  <strong>{{ 'education.university.prep.focus_label' | transloco }}:</strong>
                  <span>{{ 'education.university.prep.focus' | transloco }}</span>
                </div>
                <div class="institution-info">
                  <strong>{{ 'education.university.prep.institution_label' | transloco }}:</strong>
                  <a
                    href="https://ensam.um5.ac.ma/"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="institution-link"
                  >
                    {{ 'education.university.prep.institution' | transloco }}
                    <i class="fas fa-external-link-alt external-link"></i>
                  </a>
                </div>
                <div class="description-info">
                  <p class="description">
                    {{ 'education.university.prep.description' | transloco }}
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Certifications Section -->
    <div class="certifications-section" [class.animate-in]="visibleSections.has('certifications')">
      <div class="certifications-header">
        <h2 class="certifications-title">
          <i class="fas fa-certificate certifications-icon"></i>
          {{ 'education.certifications.title' | transloco }}
        </h2>
      </div>

      <!-- Loading State -->
      @if (isLoading) {
      <div class="certifications-loading">
        <div class="spinner"></div>
        <p>{{ 'education.certifications.loading' | transloco }}</p>
      </div>
      }

      <!-- Certifications List -->
      @if (!isLoading && displayedCertifications.length > 0) {
      <div class="certifications-list">
        @for (cert of displayedCertifications; track trackCertification($index, cert)) {
        <div
          class="certification-item"
          [class]="getProviderClass(cert.provider)"
          [class.expanded]="expandedCert === cert.id"
          [class.skill-track]="cert.type === 'skill-track'"
          (click)="toggleCertification(cert.id)"
        >
          <div class="cert-header">
            <div class="cert-provider">
              <div class="provider-badge" [class]="getProviderClass(cert.provider)">
                {{ cert.provider }}
              </div>
            </div>

            <div class="cert-info">
              <div class="cert-title-wrapper">
                <h3 class="cert-title">
                  {{ cert.title }}
                  @if (cert.type === 'skill-track') {
                  <span class="skill-track-badge">
                    <i class="fas fa-layer-group"></i>
                    {{ cert.subCertifications?.length }}
                    {{ 'education.certifications.courses' | transloco }}
                  </span>
                  }
                </h3>
              </div>
              <p class="cert-description">{{ cert.description }}</p>
            </div>

            <div class="cert-actions">
              <a
                [href]="cert.credentialUrl"
                target="_blank"
                rel="noopener noreferrer"
                class="cert-button"
                [class]="getProviderClass(cert.provider)"
                (click)="openCredential(cert.credentialUrl, $event)"
              >
                {{ 'education.certifications.view_certificate' | transloco }}
              </a>
              <button
                class="expand-button"
                [class.expanded]="expandedCert === cert.id"
                [attr.aria-label]="'Expand ' + cert.title"
              >
                <i class="fas fa-chevron-down expand-icon"></i>
              </button>
            </div>
          </div>

          <div class="cert-details" [class.show]="expandedCert === cert.id">
            <div class="details-content">
              <!-- Main Skills -->
              <div class="skills-learned">
                <h4>{{ 'education.certifications.skills_acquired' | transloco }}</h4>
                <ul class="skills-list">
                  @for (skill of cert.skills; track skill) {
                  <li>{{ skill }}</li>
                  }
                </ul>
              </div>

              <!-- Sub-certifications (for skill-tracks) -->
              @if (cert.subCertifications && cert.subCertifications.length > 0) {
              <div class="sub-certifications">
                <h4>
                  <i class="fas fa-certificate"></i>
                  {{ 'education.certifications.completed_courses' | transloco }}
                  ({{ cert.subCertifications.length }})
                </h4>
                <div class="sub-cert-list">
                  @for (subCert of cert.subCertifications; track subCert.id) {
                  <div class="sub-cert-item" (click)="$event.stopPropagation()">
                    <span class="sub-cert-title">{{ subCert.title }}</span>
                    <a
                      [href]="subCert.credentialUrl"
                      target="_blank"
                      rel="noopener noreferrer"
                      class="sub-cert-link"
                      (click)="$event.stopPropagation()"
                    >
                      <i class="fas fa-external-link-alt"></i>
                    </a>
                  </div>
                  }
                </div>
              </div>
              }
            </div>
          </div>
        </div>
        }
      </div>

      <!-- View All Certifications Button -->
      @if (hasMoreCertifications) {
      <div class="view-all-section">
        <a routerLink="/certifications-gallery" class="view-all-button">
          <span>{{ 'education.certifications.view_all' | transloco }}</span>
          <i class="fas fa-arrow-right"></i>
        </a>
      </div>
      } }

      <!-- Empty State -->
      @if (!isLoading && displayedCertifications.length === 0) {
      <div class="certifications-empty">
        <i class="fas fa-certificate"></i>
        <p>{{ 'education.certifications.no_certifications' | transloco }}</p>
      </div>
      }
    </div>
  </div>
</section>
